<% provide(:title, "Task: #{task_title @task}") %>

<p>
  <b>Assigned to:</b>
  <%= link_to @task.user.name, @task.user %>
</p>

<p>
  <b>Task status:</b>
  <%= @task.task_status.description %>
</p>

<p>
  <b>Notes:</b>
  <div>
    <%= link_to_show '[add a note]' do %>
      <% form_tag "/tasks/#{@task.id}/notes", :method => :post do %>
        <div style="padding: 0.5em">
          <%= submit_tag 'Add note' %>
          <br />Also change status:
          <%= select_tag :task_status_id, options_from_collection_for_select(@task.task_type.task_statuses, :id, :description), :include_blank => true %>
          <br />Also reassign:
          <%= select_tag :user_id, options_from_collection_for_select(User.where(:active => true), :id, :name), :include_blank => true %>
        </div>
        <%= text_area_tag 'content', nil, :size => '80x6' %>
      <% end %>
    <% end %>
  </div>
  <% @task.notes.order('created_at DESC').each do |n| %>
    <div class="note">
      <div class="note_header">
        <span><%= n.user.name %></span>
        <span style="float: right"><%= n.created_at.in_time_zone('Pacific Time (US & Canada)').to_formatted_s(:long_ordinal) %></span>
      </div>
      <div class="note_body"><%= n.content %></div>
    </div>
  <% end %>
</p>

<%= link_to '[edit this task]', edit_task_path(@task), :class => :action %> |
<%= link_to '[go back to task list]', tasks_path, :class => :action %>
